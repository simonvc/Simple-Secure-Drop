function encrypt(public_key_file) {
/* //jquery can load a publickey from file name, I only got this to work when I ran it on a real server
jQuery.get(public_key_file, function(data) {
    run(data);
});*/
var pub_key =
  ['-----BEGIN PGP PUBLIC KEY BLOCK-----',
'Version: SKS 1.1.5',
'Comment: Hostname: pgp.mit.edu',
'',
'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',
'/xrH89dRQ0yzkRQQfCUiIw==',
'=dnom',
'-----END PGP PUBLIC KEY BLOCK-----'].join('\n');
run(pub_key);
}
function run(pubkey) {
    if (window.crypto.getRandomValues) {  
        if ($('#button').html() === "Encrypt") {
			var openpgp = typeof window !== 'undefined' && window.openpgp ? window.openpgp : require('openpgp.min');
			openpgp.initWorker({ path:'openpgp.worker.min.js' });
			openpgp.config.aead_protect = false;
			var options = {
    			data: $('#input').val(),
    			publicKeys: openpgp.key.readArmored(pubkey).keys
			};
			openpgp.encrypt(options).then(function(ciphertext) {
				$('#input').val(ciphertext.data);
			});
            $('#button').html("Clear");  
            return true;  
        } else {  
            $('#input').val("");
            $('#button').html("Encrypt");  
        }  
   } else {  
        $("#button").val("Error");  
        window.alert("This browser isn't supported!");  
        return false;  
    }  
}  
